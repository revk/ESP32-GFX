#!/bin/csh -f
# Bodgy script to make fonts... Use the fonts I commit, probably easier
make fontpack
setenv d `pwd`
if(! -e include) then
	echo run in main dir
	exit 1
endif
/projects/tools/bin/5x9 --style=vector96 > "$d/include/vector96.h"
/projects/tools/bin/5x9 --style=vector > "$d/include/vector.h"
inkscape --actions="export-area-page;export-background:white;export-filename:$d/7seg.png;export-do" $d/7seg.svg

if(! -e /tmp/7seg) then
	mkdir /tmp/7seg
	cd /tmp/7seg
	foreach s (a b c d e f g h i j)
		echo $s
		inkscape --actions="export-id:$s;export-id-only;export-area-page;export-background:white;export-filename:$s.png;export-do" $d/SevenSeg.svg >& /dev/null
	end
endif

foreach n (1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20)
	@ W = $n * 7
	@ H = $n * 9
	cd /tmp/7seg
	set f="7seg$n.h"
	echo "$f"
	foreach s ([a-j].png)
		convert $s:r.png -flatten -negate -monochrome -dither None -scale ${W}x${H}'!' $s:r.gray
	end

	$d/fontpack -w$W -h$H -b1 [a-j].gray --head="gfx_7seg$n" > "$d/include/$f"
	$d/fontpack -w$W -h$H -b1 [a-j].gray --pack --head="gfx_7seg_pack$n" > "$d/include/pack$f"
end
